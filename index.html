<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WikiType - Typing Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #000;
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            width: 100%;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5rem;
            color: #4CAF50;
            margin-bottom: 10px;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .time-btn {
            padding: 8px 15px;
            background-color: #333;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .time-btn:hover {
            background-color: #555;
        }
        
        .time-btn.active {
            background-color: #4CAF50;
        }
        
        .start-btn {
            padding: 10px 25px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .start-btn:hover {
            background-color: #3e8e41;
        }
        
        .timer {
            font-size: 1.8rem;
            text-align: center;
            margin: 15px 0;
            color: #4CAF50;
            font-weight: bold;
        }
        
        .text-display {
            background-color: #111;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            min-height: 150px;
            line-height: 1.6;
        }
        
        .typing-area {
            position: relative;
            margin-bottom: 30px;
        }
        
        textarea {
            width: 100%;
            height: 120px;
            background-color: #222;
            color: white;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 15px;
            font-size: 1.1rem;
            resize: none;
        }
        
        textarea:focus {
            outline: none;
            border-color: #4CAF50;
        }
        
        .results {
            text-align: center;
            display: none;
            background-color: #111;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .results h2 {
            color: #4CAF50;
            margin-bottom: 15px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .stat-label {
            color: #999;
        }
        
        .restart-btn {
            padding: 10px 25px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .restart-btn:hover {
            background-color: #3e8e41;
        }
        
        .current-char {
            background-color: #333;
            border-radius: 2px;
        }
        
        .correct {
            color: #4CAF50;
        }
        
        .incorrect {
            color: #F44336;
            text-decoration: underline;
        }
        
        .fade {
            animation: fade 0.5s ease-in-out;
        }
        
        @keyframes fade {
            0% { background-color: #4CAF50; }
            100% { background-color: transparent; }
        }
        
        .incorrect-fade {
            animation: incorrectFade 0.5s ease-in-out;
        }
        
        @keyframes incorrectFade {
            0% { background-color: #F44336; }
            100% { background-color: transparent; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>WikiType</h1>
            <p>Test your typing speed with interesting Wikipedia content</p>
        </header>
        
        <div class="controls">
            <button class="time-btn" data-time="1">1 Minute</button>
            <button class="time-btn" data-time="2">2 Minutes</button>
            <button class="time-btn active" data-time="3">3 Minutes</button>
            <button class="time-btn" data-time="4">4 Minutes</button>
            <button class="time-btn" data-time="5">5 Minutes</button>
            <button class="start-btn">Start Test</button>
        </div>
        
        <div class="timer">03:00</div>
        
        <div class="text-display">
            <p>Select a test duration and click Start Test to begin. The text will appear here.</p>
        </div>
        
        <div class="typing-area">
            <textarea placeholder="Start typing here... (the text will appear above)" disabled></textarea>
        </div>
        
        <div class="results">
            <h2>Test Results</h2>
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="wpm">0</div>
                    <div class="stat-label">WPM</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="accuracy">0%</div>
                    <div class="stat-label">Accuracy</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="time-taken">0s</div>
                    <div class="stat-label">Time</div>
                </div>
            </div>
            <button class="restart-btn">Try Again</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elements
            const timeButtons = document.querySelectorAll('.time-btn');
            const startButton = document.querySelector('.start-btn');
            const timerDisplay = document.querySelector('.timer');
            const textDisplay = document.querySelector('.text-display');
            const typingArea = document.querySelector('textarea');
            const resultsSection = document.querySelector('.results');
            const wpmElement = document.getElementById('wpm');
            const accuracyElement = document.getElementById('accuracy');
            const timeTakenElement = document.getElementById('time-taken');
            const restartButton = document.querySelector('.restart-btn');
            
            // Variables
            let originalText = '';
            let timer;
            let timeLeft = 180; // 3 minutes in seconds (default)
            let testActive = false;
            let startTime;
            let errors = 0;
            let totalTyped = 0;
            
            // Time button selection
            timeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    timeButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    const minutes = parseInt(this.dataset.time);
                    timeLeft = minutes * 60;
                    updateTimerDisplay();
                });
            });
            
            // Update timer display
            function updateTimerDisplay() {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            // Start the test
            startButton.addEventListener('click', startTest);
            
            function startTest() {
                if (testActive) return;
                
                // Reset state
                clearInterval(timer);
                testActive = true;
                errors = 0;
                totalTyped = 0;
                resultsSection.style.display = 'none';
                typingArea.disabled = false;
                typingArea.value = '';
                startButton.disabled = true;
                timeButtons.forEach(btn => btn.disabled = true);
                
                // Fetch Wikipedia content
                fetchWikipediaContent();
                
                // Start timer
                startTime = new Date();
                timer = setInterval(function() {
                    timeLeft--;
                    updateTimerDisplay();
                    
                    if (timeLeft <= 0) {
                        endTest();
                    }
                }, 1000);
                
                // Focus typing area
                setTimeout(() => typingArea.focus(), 100);
            }
            
            // Fetch content from Wikipedia
            async function fetchWikipediaContent() {
                try {
                    textDisplay.innerHTML = '<p>Loading interesting content from Wikipedia...</p>';
                    
                    // We'll use the Wikipedia API to get a random article excerpt
                    const response = await fetch('https://en.wikipedia.org/api/rest_v1/page/random/summary');
                    const data = await response.json();
                    
                    // Use the extract as our typing text
                    originalText = data.extract;
                    renderText();
                } catch (error) {
                    console.error('Error fetching Wikipedia content:', error);
                    // Fallback text if Wikipedia API fails
                    originalText = "Typing is the process of writing text by pressing keys on a typewriter, computer keyboard, mobile phone, or calculator. It can be distinguished from other means of text input, such as handwriting and speech recognition. Text can be in the form of letters, numbers and other symbols. The world's first typist was Lillian Sholes from Wisconsin, who was the daughter of Christopher Sholes, the inventor of the first practical typewriter.";
                    renderText();
                }
            }
            
            // Render the text with styling
            function renderText() {
                textDisplay.innerHTML = '';
                const paragraph = document.createElement('p');
                
                // Add each character as a span
                originalText.split('').forEach(char => {
                    const charSpan = document.createElement('span');
                    charSpan.textContent = char;
                    paragraph.appendChild(charSpan);
                });
                
                textDisplay.appendChild(paragraph);
                
                // Highlight the first character
                if (textDisplay.querySelector('span')) {
                    textDisplay.querySelector('span').classList.add('current-char');
                }
            }
            
            // Typing event handler
            typingArea.addEventListener('input', function() {
                if (!testActive) return;
                
                const typedText = typingArea.value;
                totalTyped = typedText.length;
                
                // Check each character
                const textSpans = textDisplay.querySelectorAll('span');
                let allCorrect = true;
                
                textSpans.forEach((span, index) => {
                    // Remove existing classes
                    span.classList.remove('correct', 'incorrect', 'current-char', 'fade', 'incorrect-fade');
                    
                    if (index < typedText.length) {
                        if (typedText[index] === originalText[index]) {
                            span.classList.add('correct');
                            // Add fade effect for correct characters
                            if (index === typedText.length - 1) {
                                span.classList.add('fade');
                            }
                        } else {
                            span.classList.add('incorrect');
                            // Add fade effect for incorrect characters
                            if (index === typedText.length - 1) {
                                span.classList.add('incorrect-fade');
                            }
                            allCorrect = false;
                            if (index === typedText.length - 1) {
                                errors++;
                            }
                        }
                    }
                    
                    // Highlight current character
                    if (index === typedText.length) {
                        span.classList.add('current-char');
                    }
                });
                
                // If user has typed everything correctly and reached the end
                if (typedText.length === originalText.length && allCorrect) {
                    endTest();
                }
            });
            
            // End the test
            function endTest() {
                clearInterval(timer);
                testActive = false;
                typingArea.disabled = true;
                startButton.disabled = false;
                timeButtons.forEach(btn => btn.disabled = false);
                
                const endTime = new Date();
                const timeTaken = (endTime - startTime) / 1000; // in seconds
                const minutes = timeTaken / 60;
                
                // Calculate WPM (assuming average word length of 5 characters)
                const words = totalTyped / 5;
                const wpm = Math.round(words / (timeTaken / 60));
                
                // Calculate accuracy
                const accuracy = totalTyped > 0 ? Math.max(0, Math.round(((totalTyped - errors) / totalTyped) * 100)) : 0;
                
                // Display results
                wpmElement.textContent = wpm;
                accuracyElement.textContent = `${accuracy}%`;
                timeTakenElement.textContent = `${Math.round(timeTaken)}s`;
                resultsSection.style.display = 'block';
            }
            
            // Restart test
            restartButton.addEventListener('click', function() {
                // Reset to default time
                timeButtons.forEach(btn => {
                    btn.disabled = false;
                    if (btn.dataset.time === '3') {
                        btn.classList.add('active');
                        timeLeft = 180;
                    } else {
                        btn.classList.remove('active');
                    }
                });
                
                updateTimerDisplay();
                resultsSection.style.display = 'none';
                textDisplay.innerHTML = '<p>Select a test duration and click Start Test to begin. The text will appear here.</p>';
            });
            
            // Initialize timer display
            updateTimerDisplay();
        });
    </script>
</body>
</html>
